-- Use the database
USE CoupleCentsDB;

-- Family Table
CREATE TABLE Family (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    CreatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Users Table
CREATE TABLE User (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    FamilyId INT NOT NULL,
    CreatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (FamilyId) REFERENCES Family(Id)
);

-- ExpenseTypes Table
CREATE TABLE ExpenseType (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    CreatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Expenses Table
CREATE TABLE Expense (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(200) NOT NULL,
    TypeId INT NOT NULL,
    AffectsFamilyBudget BOOLEAN NOT NULL DEFAULT FALSE,
    WhoItAffects INT NULL,
    Icon VARCHAR(50) NULL,
    CreatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (TypeId) REFERENCES ExpenseType(Id),
    FOREIGN KEY (WhoItAffects) REFERENCES User(Id)
);

-- Keywords Table
CREATE TABLE Keyword (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    ExpenseId INT NOT NULL,
    CreatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ExpenseId) REFERENCES Expense(Id) ON DELETE CASCADE
);